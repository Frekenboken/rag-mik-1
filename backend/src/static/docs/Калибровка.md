# **Инструкция по калибровке станций контроля МИК-1**

## **Общие требования к калибровке**

### **Периодичность**

Система инспекционного контроля МИК-1, как высокоточный многофункциональный автоматизированный комплекс, требует строгого соблюдения регламента калибровочных и проверочных работ для поддержания заданной в Техническом задании точности и стабильности обнаружения дефектов.

* **Ежедневно**: Производится процедура визуального контроля состояния основных рабочих узлов и поверхностей. Это включает проверку чистоты оптических элементов (камер, линз, защитных стекол), осветительных блоков, а также контроль отсутствия посторонних предметов и механических повреждений на карусельном механизме, механизмах подачи и сброса. Особое внимание уделяется чистоте эталонных стекол и правильности их хранения.  
* **Еженедельно**: Выполняется полная калибровка всех измерительных станций в строгом соответствии с данной инструкцией. Полная калибровка включает в себя механическую юстировку, программную настройку по эталонам и финальную проверку точности на наборе тестовых образцов, содержащих критические и некритические дефекты. Эта процедура критически важна для систем, использующих нейросетевые алгоритмы, для предотвращения дрейфа весов модели и поддержания заявленной точности (Accuracy **больше или равно** 99.5%).  
* **После замены компонентов**: Любая замена или ремонт ключевых измерительных, оптических или механических компонентов (датчики, камеры, осветительные блоки, элементы пневмосистемы, управляющие платы) требует немедленной и обязательной внеплановой калибровки соответствующей станции и, по возможности, комплексной проверки всей системы. Это обусловлено необходимостью интеграции новых параметров и характеристик в существующую измерительную модель.  
* **При смене типа продукции**: При переходе на контроль стеклоизделий с другими геометрическими параметрами (например, с бутылок на пенициллиновые флаконы) или с другим цветом стекла (например, с БС на ЗС-2), необходимо провести проверку и корректировку параметров контроля. В частности, требуется внести изменения в настройки освещения для оптических станций (Станции 3-5, 6) согласно таблице lighting_params и, возможно, выполнить дообучение нейросети на новых образцах, особенно если геометрия сечения изделия является нестандартной (прямоугольной, овальной или комбинированной).

### **Необходимые инструменты и эталоны**

Для проведения корректной и полной калибровки системы МИК-1 необходим строго регламентированный набор измерительного оборудования и эталонных образцов, которые должны храниться в условиях, исключающих их загрязнение или механическое повреждение.

### **Базовый набор**

1. **Эталон геометрии** - Используется для калибровки Станции 1 (Контроль диаметра венчика и высоты) и Станции 9 (Контроль овальности). Требуются высокоточные цилиндрические эталоны с жестко регламентированными размерами: **диаметр 50 плюс-минус 0.01 мм, высота=100 плюс-минус 0.01 мм**. Дополнительно могут использоваться эталоны других диаметров (например, 25 мм, 100 мм, 150 мм) для проверки линейности измерения в полном рабочем диапазоне системы МИК-1 (диаметр от 25 мм до 150 мм).  
2. **Эталон с дефектами** - Представляет собой набор эталонных стеклоизделий (бутылки, флаконы) с точно нанесенными и проклассифицированными дефектами, минимальные размеры которых соответствуют критическим значениям из ТЗ (трещины от 0.3-0.5 мм, пузыри, сколы). Используется для проверки точности алгоритмов детекции (Recall **больше или равно** 99%) на станциях 3-6 и для проверки работы алгоритма герметичности на Станции 2 (образцы с имитацией контролируемой утечки).  
3. **Манометр** - Используется для контроля и калибровки Станции 2 (Контроль герметичности). Требуется высокоточный эталонный манометр класса точности 0.4 или выше, способный точно измерять низкие перепады давления в диапазоне до 10 мбар, что является рабочим давлением контроля герметичности согласно ТЗ.  
4. **Калибровочное стекло** - Необходимы образцы стекла основных цветов, контролируемых МИК-1, для точной настройки баланса белого и экспозиции оптических станций: **БС** (бесцветное), **ПС** (полубелое), **ЗС** (зеленое) для каждого типа контролируемого изделия. Образцы должны иметь однородную структуру без видимых дефектов.  
5. **Чистящие средства** - Для обеспечения максимальной прозрачности оптического тракта и отсутствия влияния загрязнений на точность измерения: **изопропиловый спирт** (IPA, не менее 99.7%) и специализированная **безворсовая ткань** или салфетки, не оставляющие микрочастиц и разводов.

## **Станция 1: Контроль диаметра венчика и высоты**

Станция 1 является одной из базовых станций, использующей оптический датчик для измерения критических параметров геометрии с точностью **плюс-минус 0.1 мм**.

### **Подготовка**

Строгое соблюдение климатических и механических условий окружающей среды является критическим фактором для сохранения точности оптических измерений.

Температура: 20±2°C  
Влажность: 45-65%  
Вибрация: отсутствует  
Освещение: выключить внешнее

Поддержание **температуры 20 +/- 2°C** необходимо для минимизации теплового расширения и сжатия как самого измерительного оборудования, так и калибровочных эталонов. Влажность в пределах 45-65% предотвращает образование конденсата на оптике и электронных компонентах. **Отсутствие вибрации** — обязательное условие, так как вибрации могут вызвать ошибки позиционирования датчика и смазывание оптического изображения. **Внешнее освещение должно быть выключено** для исключения паразитных засветок, которые могут повлиять на работу оптического датчика.

### **Процедура калибровки**

Процедура состоит из двух основных этапов: механической юстировки и программной калибровки измерительной шкалы.

**Шаг 1: Механическая настройка**

Точность оптического измерения напрямую зависит от правильного позиционирования датчика относительно траектории движения изделия.

1. Проверить положение датчика относительно оси вращения  
2. Расстояние до изделия: **50 плюс-минус 1 мм**  
3. Угол установки: 90° к поверхности

**Шаг 2: Программная калибровка**

После механической юстировки необходимо провести программную калибровку для линеаризации и масштабирования показаний датчика.

Меню -> Настройки -> Станция 1 -> Калибровка  
1. Установить эталон ?50 мм  
2. Нажать [Измерить эталон]  
3. Ввести реальное значение: 50.00 мм  
4. Повторить для эталона ?100 мм  
5. Проверить линейность: R? > 0.9999

1. **Установить эталон ?50 мм**: Поместить в измерительную зону цилиндрический эталон с диаметром 50.00 мм.  
2. **Нажать [Измерить эталон]**: Система производит измерение текущих показаний.  
3. **Ввести реальное значение: 50.00 мм**: Ввод эталонного значения используется для установки нулевой точки смещения и первичной калибровки шкалы.  
4. **Повторить для эталона ?100 мм**: Повторение процедуры с эталоном, расположенным в другой части рабочего диапазона (100.00 мм), позволяет определить коэффициент масштабирования и скорректировать нелинейность.  
5. **Проверить линейность: R? больше 0.9999**: Система должна автоматически рассчитать коэффициент детерминации (R^2) для линии, построенной по двум или более точкам калибровки. Значение R^2 **больше** 0.9999 является критически важным требованием к линейности измерительной системы, гарантирующим точность плюс-минус 0.1 мм во всем рабочем диапазоне (25-150 мм).

**Шаг 3: Проверка точности**

Финальная проверка осуществляется с использованием набора эталонов для подтверждения, что фактическая погрешность измерения находится в допустимых пределах плюс-минус 0.1 мм.

| Эталон | Допустимое отклонение | Действие при превышении |
| :---- | :---- | :---- |
| ?25 мм | плюс-минус 0.1 мм | Повторить калибровку |
| ?50 мм | плюс-минус 0.1 мм | Проверить фокус |
| ?100 мм | плюс-минус 0.1 мм | Заменить датчик |
| ?150 мм | плюс-минус 0.1 мм | Вызвать сервис |

Измерение **диаметра 25 мм** и **диаметра 150 мм** является проверкой работы на крайних точках рабочего диапазона. При превышении допустимого отклонения для диаметра 100 мм (средний диапазон) это часто указывает на деградацию самого датчика, что требует его замены. Превышение отклонения на диаметре 50 мм может быть устранено проверкой фокусного расстояния.

### **Типичные проблемы**

* **Дрейф показаний** - Проверить температурную стабильность. Дрейф, как правило, является следствием неравномерного нагрева компонентов или изменения температуры окружающей среды, что приводит к медленному изменению геометрических размеров датчика и эталона. Обеспечить соблюдение условий подготовки (20 +/- 2°C).  
* **Нелинейность** - Очистить оптику. Загрязнение оптических элементов (линз, защитных стекол) вызывает рассеивание и поглощение света, что особенно заметно на краях диапазона измерений и приводит к нелинейности.  
* **Шум в измерениях** - Устранить вибрацию. Высокочастотные шумы в измерениях практически всегда являются следствием внешних вибраций (от конвейера, другого оборудования), которые нарушают стабильность положения датчика. Требуется проверка виброизоляции и демпфирования системы МИК-1.

## **Станция 2: Контроль герметичности**

Станция 2 использует высокочувствительный датчик давления для контроля герметичности стеклоизделий, включая плоскостность горловины. Давление тестирования находится в диапазоне **8-10 мбар**, согласно ТЗ.

### **Настройка пневмосистемы**

Настройка пневмосистемы критически важна для обеспечения стабильного и воспроизводимого цикла контроля.

### **Базовые параметры**

Герметичность  
Давление тестирования = 8-10 мбар  
Время стабилизации = 100 мс  
Время измерения = 200 мс  
Порог утечки = 0.5 мбар

**Давление_тестирования**: Диапазон 8-10 мбар является оптимальным для обнаружения критических дефектов герметичности с минимальными размерами утечек (трещины, сколы).  
**Время_стабилизации**: **100 мс** — это минимально необходимое время для достижения равновесия давления внутри тестируемой емкости после подачи давления 8-10 мбар, что исключает ошибки, связанные с динамикой процесса.  
**Время_измерения**: **200 мс** — период, в течение которого датчик давления фиксирует падение давления. Этот период должен быть достаточен для обнаружения падения давления на 0.5 мбар, но при этом обеспечивать производительность до 400 изделий/мин (т.е., время анализа **меньше или равно** 240 мс).  
**Порог_утечки**: **0.5 мбар** — это абсолютное максимально допустимое падение давления в течение времени измерения. Падение, превышающее это значение, классифицируется как брак.

### **Калибровка датчика давления**

Калибровка датчика давления обеспечивает высокую точность в низком диапазоне (0-10 мбар) и производится с помощью эталонного манометра класса 0.4.

1. **Нулевая точка**  
   Открыть атмосферу  
   Нажать [Установить ноль]  
   Показания: **0.00 плюс-минус 0.01 мбар**  
2. **Калибровка диапазона**  
   Подать эталонное давление 10 мбар  
   Нажать [Калибровать диапазон]  
   Проверить линейность: Повторная проверка линейности в точках 2, 5, 8 мбар. Коэффициент R^2 должен быть **больше или равен** 0.9999.  
3. Проверка на эталонах  
   Финальный функциональный тест, подтверждающий способность системы обнаруживать заданные дефекты.

Эталон без дефекта -> PASS  
Эталон с отверстием 0.1 мм -> FAIL  
Эталон с трещиной 0.5 мм -> FAIL

4.   
   **Эталон без дефекта**: Должен обеспечить показание падения давления **меньше или равно** 0.5 мбар (PASS).  
   **Эталон с отверстием 0.1 мм**: Имитация микротрещины. Должен показать падение **больше или равно** 0.5 мбар (FAIL).  
   **Эталон с трещиной 0.5 мм**: Имитация критического дефекта. Должен показать значительное падение давления (FAIL).

### **Настройка алгоритма детекции**

Настройка алгоритма включает определение пороговых значений скорости падения давления и абсолютного падения, которые являются критериями классификации изделия как бракованного.

### **Параметры обнаружения**

**Скорость падения давления**: **больше** 0.5 мбар/с = брак.  
**Абсолютное падение**: **больше** 1 мбар за цикл = брак.  
**Время реакции**: **меньше** 50 мс.

## **Станция 3-5: Оптический контроль посечек**

Станции 3, 4 и 5 отвечают за оптический контроль посечек (микротрещин), расположенных на горловине, дне, переходе и корпусе, используя различные методы освещения, включая инфракрасные лучи (Станция 5) для обеспечения сквозного контроля.

### **Общая методика для оптических станций**

Для достижения требуемой точности (Precision **больше или равно** 98%) необходимо обеспечить стандартизированные и оптимальные условия освещения и захвата изображения.

### **Настройка освещения**

Параметры освещения должны быть скорректированы в зависимости от цвета контролируемого стекла (ГОСТ 34382), так как различные оксиды (Fe2O3, Cr2O3) по-разному поглощают и рассеивают свет.

Python

# Параметры для разных типов стекла  
lighting_params = {  
    "БС": {"intensity": 80, "angle": 45},  # Бесцветное  
    "ЗС": {"intensity": 100, "angle": 30},  # Зеленое  
    "КС": {"intensity": 120, "angle": 35},  # Коричневое  
}

**Бесцветное (БС, Fe2O3 <= 0.1%)**: Требуется умеренная интенсивность (80%) и угол 45 градусов для максимального контраста посечек, работающих как призма.  
**Зеленое (ЗС-1, ЗС-2)**: Требуется более высокая интенсивность (100%) из-за поглощения света оксидом хрома (Cr203) или оксидом железа (Fe2O3). Угол 30 градусов лучше выделяет дефекты на фоне более темного стекла.  
**Коричневое (КС)**: Наиболее высокая интенсивность (120%) требуется из-за сильного поглощения, которое может маскировать мелкие дефекты.

### **Калибровка камер**

Камеры с высоким разрешением, используемые в МИК-1, требуют точной настройки фокуса, баланса белого и экспозиции.

1. **Фокусировка**  
   * Установить калибровочную мишень (микрошкала).  
   * Автофокус или ручная настройка  
   * Критерий: MTF **больше** 0.6  
2. **Баланс белого**  
   * Использовать серую карту 18%  
   * Автоматическая коррекция  
   * RGB девиация **меньше** 5%  
3. **Экспозиция**  
   * Целевая яркость: **128 плюс-минус 20** (8 бит)  
   * Избегать пересветов  
   * Контроль по гистограмме

### **Обучение нейросети на дефектах**

МИК-1 использует нейросетевые алгоритмы для обработки сложных дефектов, что требует периодического дообучения (Fine-tuning) модели.

### **Подготовка образцов**

1. Минимум 100 образцов каждого типа дефекта  
2. Разметка границ дефектов  
3. Классификация по критичности

### **Процесс обучения**

1. Загрузить базовую модель  
2. Добавить новые образцы в датасет  
3. Запустить дообучение (10-15 мин)  
4. Валидация на тестовой выборке  
5. Сохранить новую версию модели

1. **Загрузить базовую модель**: Использование последней стабильной версии модели, хранящейся в системе.  
2. **Добавить новые образцы**: Интегрировать в обучающий набор последние 1000 дефектных образов, сохраненных системой, а также специально подготовленные эталоны.  
3. **Запустить дообучение (10-15 мин)**: Процесс Fine-tuning должен быть быстрым.  
4. **Валидация на тестовой выборке**: Проверка новой модели на независимом тестовом наборе, который не использовался для обучения, для подтверждения, что **F1-score больше или равно 98.5%** и **вероятность пропуска критического брака меньше 0.5%**.  
5. **Сохранить новую версию модели**: Сохранение новой версии с автоматической нумерацией и фиксацией даты и времени.

## **Станция 6: Контроль поверхности венчика**

Станция 6 выполняет высокодетальный контроль поверхности венчика, требующий обнаружения дефектов размером от 0.1 мм.

### **Особенности калибровки**

Требуется высокое разрешение для детекции:

* Микротрещин (от 0.1 мм)  
* Свилей  
* Пузырей (от 0.3 мм)  
* Отрывов материала

### **Настройка мультиспектрального освещения**

Для повышения контрастности различных типов дефектов используются источники света с разными длинами волн.

| Источник | Длина волны | Назначение |
| :---- | :---- | :---- |
| УФ | 365 нм | Флуоресценция дефектов |
| Белый | 400-700 нм | Общий контроль |
| ИК | 850 нм | Внутренние дефекты |

## **Станция 9: Контроль овальности**

Станция 9 (опциональная) предназначена для определения отклонений от идеальной круглой геометрии с точностью **плюс-минус 0.1 мм** для контроля изделий с круглой и комбинированной геометрией сечения.

### **Математическая модель**

Овальность определяется как относительная разница между максимальным (D_max) и минимальным (D_min) измеренными диаметрами, нормализованная на средний диаметр (D_ср).

Овальность = (D_max - D_min) / D_ср * 100%

**Допуск**: **меньше** 2% для стандартной продукции.

### **Калибровка многоточечного измерения**

Измерение овальности требует одновременного или последовательного измерения диаметра в нескольких точках (минимум 8), пока изделие вращается.

1. Установить идеально круглый эталон  
2. Измерить в 8 точках по окружности  
3. Стандартное отклонение **меньше** 0.05 мм  
4. Проверить на овальном эталоне (овальность 5%)

## **Комплексная проверка после калибровки**

После успешной калибровки всех станций проводится комплексная проверка для подтверждения работоспособности всей системы МИК-1 в условиях, максимально приближенных к производственным, и соответствия требованиям ТЗ к точности (Accuracy **больше или равно** 99.5%).

### **Тестовый прогон**

1. Запустить 100 эталонных изделий  
2. Проверить показатели:  
   Обнаружение дефектов (Recall): **больше** 99%  
   Ложные срабатывания (False Positives): **меньше** 2%  
   Скорость обработки: соответствует ТЗ

### **Документирование результатов**

Markdown

## Протокол калибровки №**__*_***  
***Дата: ___________***  
***Исполнитель: ___________***

***### Станция 1: Геометрия***  
***- [ ] Механическая юстировка***  
***- [ ] Программная калибровка***    
***- [ ] Проверка точности***  
***Результат: PASS / FAIL***

***### Станция 2: Герметичность***  
***- [ ] Калибровка датчика***  
***- [ ] Настройка порогов***  
***- [ ] Проверка на эталонах***  
***Результат: PASS / FAIL***

***[... остальные станции ...]***

***Подпись: ___________***

## **Рекомендации по устранению проблем**

| Симптом | Диагностика | Решение |
| :---- | :---- | :---- |
| Дрейф калибровки | Проверить температуру | Стабилизация климата |
| Низкая повторяемость | Анализ вибраций | Виброизоляция |
| Деградация точности | Износ компонентов | Замена изношенных частей |
| Сбои ПО | Логи системы | Обновление/переустановка |
| **Несоответствие Recall > 99%** | **Переобучение нейросети** | **Добавить новые дефекты** |
| **Ложный брак > 2%** | **Баланс белого, фокус** | **Корректировка освещения** |
| **Пропуск критического брака** | **Проверить ИК/УФ каналы** | **Очистка оптических фильтров** |
| **Нестабильность сброса** | **Давление выталкивания** | **Настройка 4-6 бар (по ТЗ)** |

## **Контрольные вопросы для RAG-системы**

1. "Какое расстояние должно быть от датчика до изделия при калибровке геометрии?"  
2. "Как часто нужно калибровать станцию герметичности?"  
3. "Какой должна быть овальность для стандартной продукции?"  
4. "Что делать при дрейфе показаний датчика?"  
5. "Какие параметры освещения для зеленого стекла?"

